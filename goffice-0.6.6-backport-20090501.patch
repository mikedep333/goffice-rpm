From bfcd25ce71fce582af48f834c14a956249dc3ea6 Mon Sep 17 00:00:00 2001
From: Jody Goldberg <jody@gnome.org>
Date: Fri, 01 May 2009 10:36:42 +0000
Subject: * Patch foocanvas to work around behaviour change in gtk 2.14. [#566652]

---
diff --git a/ChangeLog b/ChangeLog
index 02e99eb..dd3fdc1 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,8 @@
+2008-10-08  Jody Goldberg <jody@gnome.org>
+
+	* goffice/cut-n-paste/foocanvas/foo-canvas.c (foo_canvas_crossing) :
+	  simplistic patch to repair gtk-2.14 related breakage.
+
 2009-03-06  Jean Brefort  <jean.brefort@normalesup.org>
 
 	* plugins/plot_distrib/gog-histogram.c: don't show a marker in the
diff --git a/NEWS b/NEWS
index 58110e2..0954ebd 100644
--- a/NEWS
+++ b/NEWS
@@ -3,8 +3,11 @@ goffice 0.6.7:
 Jean:
 	* Fixed crash when adding series to bar chart. [#572354]
 	* Don't display markers in histogram legend. [#574340]
-	* Skip points corresponding to invalid valies in pie charts. [#574348]
+	* Skip points corresponding to invalid values in pie charts. [#574348]
 	
+Jody:
+	* Patch foocanvas to work around behaviour change in gtk 2.14. [#566652]
+
 --------------------------------------------------------------------------
 goffice 0.6.6:
 
diff --git a/goffice/cut-n-paste/foocanvas/foo-canvas.c b/goffice/cut-n-paste/foocanvas/foo-canvas.c
index f5c4ceb..45a014c 100644
--- a/goffice/cut-n-paste/foocanvas/foo-canvas.c
+++ b/goffice/cut-n-paste/foocanvas/foo-canvas.c
@@ -2813,7 +2813,8 @@ foo_canvas_crossing (GtkWidget *widget, GdkEventCrossing *event)
 
 	canvas = FOO_CANVAS (widget);
 
-	if (event->window != canvas->layout.bin_window)
+	if (event->window != canvas->layout.bin_window ||
+	    NULL != canvas->grabbed_item)
 		return FALSE;
 
 	canvas->state = event->state;
--
cgit v0.8.2
